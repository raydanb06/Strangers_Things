(this.webpackJsonpstrangers_things=this.webpackJsonpstrangers_things||[]).push([[0],{33:function(e,t,n){"use strict";n.r(t);var r=n(3),c=n.n(r),s=n(6),a=n(4),o=n(1),u=n(17),i=n.n(u),j=n(10),l=n(2),h=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,s,a,o,u,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,s=t.token,a=t.body,e.prev=1,o={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},s&&(o.headers.Authorization="Bearer ".concat(s)),e.next=6,fetch("".concat("https://strangers-things.herokuapp.com/api/2105-SJS-RM-WEB-PT","/").concat(n),o);case 6:return u=e.sent,e.next=9,u.json();case 9:if(!(i=e.sent).error){e.next=12;break}throw i.error;case 12:return e.abrupt("return",i);case 15:e.prev=15,e.t0=e.catch(1),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),p=n(0),b=function(e){var t=e.token,n=e.fetchPosts,r=Object(o.useState)(""),u=Object(a.a)(r,2),i=u[0],j=u[1],l=Object(o.useState)(""),b=Object(a.a)(l,2),d=b[0],O=b[1],x=Object(o.useState)(""),m=Object(a.a)(x,2),f=m[0],v=m[1],g=function(){var e=Object(s.a)(c.a.mark((function e(r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,h({url:"posts",method:"POST",token:"".concat(t),body:{post:{title:"".concat(i),description:"".concat(d),price:"".concat(f)}}});case 4:e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:return e.next=12,n();case 12:j(""),O(""),v("");case 15:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{onSubmit:g,children:[Object(p.jsx)("input",{placeholder:"Title",type:"text",value:i,onChange:function(e){return j(e.target.value)}}),Object(p.jsx)("input",{placeholder:"Description",type:"text",value:d,onChange:function(e){return O(e.target.value)}}),Object(p.jsx)("input",{placeholder:"Price",type:"text",value:f,onChange:function(e){return v(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:"Add Post"})]})})},d=function(e){var t=e.token,n=e.posts,r=e.fetchPosts,c=Object(o.useState)(""),s=Object(a.a)(c,2),u=s[0],i=s[1],j=n.filter((function(e){return e.title.includes(u)}));return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"header",children:"Posts"}),Object(p.jsx)(y,{className:"search-form",posts:n,searchTerm:u,setSearchTerm:i}),!u&&t?Object(p.jsx)(b,{token:t,fetchPosts:r}):null,!u&&n.map((function(e){return Object(p.jsx)(g,{post:e,token:t,fetchPosts:r},e._id)})),u&&j.map((function(e){return Object(p.jsx)(g,{post:e,token:t},e._id)}))]})},O=function(e){var t=e.setToken;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"header",children:"LoginPage"}),Object(p.jsx)(f,{setToken:t}),Object(p.jsx)(m,{setToken:t})]})},x=function(e){var t=e.token;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"header",children:"Stranger's Things Homepage"}),t?Object(p.jsx)("div",{children:"You are logged in."}):Object(p.jsx)("div",{children:"Login to do more."})]})},m=function(e){var t=e.setToken,n=Object(o.useState)(""),r=Object(a.a)(n,2),u=r[0],i=r[1],j=Object(o.useState)(""),b=Object(a.a)(j,2),d=b[0],O=b[1],x=Object(l.e)(),m=function(){var e=Object(s.a)(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,h({url:"users/login",method:"POST",body:{user:{username:"".concat(u),password:"".concat(d)}}});case 4:(r=e.sent).data&&(t(r.data.token),r.data.token&&x.push("/")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:i(""),O("");case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{className:"header",children:"Login"}),Object(p.jsxs)("form",{onSubmit:m,children:[Object(p.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(p.jsx)("input",{placeholder:"Username",type:"text",value:u,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(p.jsx)("input",{placeholder:"Password",type:"password",value:d,onChange:function(e){return O(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:"Login"})]})]})},f=function(e){var t=e.setToken,n=Object(o.useState)(""),r=Object(a.a)(n,2),u=r[0],i=r[1],j=Object(o.useState)(""),b=Object(a.a)(j,2),d=b[0],O=b[1],x=Object(o.useState)(""),m=Object(a.a)(x,2),f=m[0],v=m[1],g=Object(l.e)(),k=function(){var e=Object(s.a)(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,h({url:"users/register",method:"POST",body:{user:{username:"".concat(u),password:"".concat(d)}}});case 4:(r=e.sent).data&&(t(r.data.token),r.data.token&&g.push("/")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:i(""),O(""),v("");case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{className:"header",children:"Register"}),Object(p.jsxs)("form",{onSubmit:k,children:[Object(p.jsx)("label",{htmlFor:"new-username",children:"Username:"}),Object(p.jsx)("input",{placeholder:"New Username",type:"text",value:u,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)("label",{htmlFor:"new-password",children:"Password:"}),Object(p.jsx)("input",{placeholder:"New Password",type:"password",value:d,onChange:function(e){return O(e.target.value)}}),Object(p.jsx)("label",{htmlFor:"new-password-check",children:"Re-enter Password:"}),Object(p.jsx)("input",{placeholder:"Re-enter New Password",type:"password",value:f,onChange:function(e){return v(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:"Register"})]})]})},v=function(e){var t=e.token,n=Object(o.useState)([]),r=Object(a.a)(n,2),u=r[0],i=r[1],j=Object(o.useState)([]),l=Object(a.a)(j,2),b=l[0],d=l[1],O=function(){var e=Object(s.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h({url:"users/me",method:"GET",token:"".concat(t)});case 3:n=e.sent,i(n.data.posts),d(n.data.messages),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){O()}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"header",children:"Profile"}),Object(p.jsx)("h2",{className:"header",children:"My Posts"}),u.map((function(e,t){return Object(p.jsxs)("div",{className:"post",children:[e.title,", ",e.description,", ",e.price]},e._id)})),Object(p.jsx)("h2",{className:"header",children:"Messages"}),b.map((function(e,t){return Object(p.jsxs)("div",{className:"message",children:[e.fromUser.username,", ",e.content," "," in "," ",e.post.title]},e._id)}))]})},g=function(e){var t=e.post,n=e.token,r=e.fetchPosts,a=function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h({url:"posts/".concat(t),method:"DELETE",token:"".concat(n)});case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:return e.next=11,r();case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"post",children:[t.title,", ",t.description,", ",t.price,t.isAuthor&&Object(p.jsx)("button",{onClick:function(){return a(t._id)},children:"Delete"}),n&&!t.isAuthor&&Object(p.jsx)(j.b,{className:"post-link",to:"/posts/".concat(t._id),children:"Message"}),n&&t.isAuthor&&Object(p.jsx)(j.b,{className:"post-link",to:"/posts/".concat(t._id),children:"View Details"})]},t._id)})},k=function(e){var t=e.token,n=e.posts,r=Object(l.f)().postId,c=n.find((function(e){return e._id===r}));return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"header",children:"Post Viewing"}),Object(p.jsx)(g,{post:c}),t&&c.isAuthor&&c.messages.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:["From User: ",e.fromUser.username,", Comment: ",e.content]})},e._id)})),t&&!c.isAuthor&&Object(p.jsx)(w,{token:t,post:c})]})},w=function(e){var t=e.token,n=e.post,r=Object(o.useState)(""),u=Object(a.a)(r,2),i=u[0],j=u[1],l=function(){var e=Object(s.a)(c.a.mark((function e(r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,h({method:"post",url:"posts/".concat(n._id,"/messages"),token:"".concat(t),body:{message:{content:i}}});case 4:e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:j("");case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{className:"header",children:"Comment"}),Object(p.jsxs)("form",{onSubmit:l,children:[Object(p.jsx)("input",{placeholder:"Comment Here",type:"text",value:i,onChange:function(e){return j(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:"Add Comment"})]})]})},y=function(e){var t=e.posts,n=e.searchTerm,r=e.setSearchTerm;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{className:"search-form",onSubmit:function(e){e.preventDefault(),console.log(t)},children:[Object(p.jsx)("input",{placeholder:"Search",type:"text",value:n,onChange:function(e){return r(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:"Search"})]})})},S=function(){var e=Object(o.useState)(""),t=Object(a.a)(e,2),n=t[0],r=t[1],u=Object(o.useState)([]),i=Object(a.a)(u,2),b=i[0],m=i[1],f=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({url:"posts",method:"GET",token:"".concat(n)});case 2:(t=e.sent).data&&m(t.data.posts);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){f()}),[n]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(j.b,{to:"/",children:"Home"})," | ",Object(p.jsx)(j.b,{to:"/posts",children:"Posts"})," | ",Object(p.jsx)(j.b,{to:"/account",children:"Login/Register"})," | ",n?Object(p.jsx)(j.b,{to:"/profile",children:"Profile"}):""," | ",n?Object(p.jsx)(j.b,{to:"/",onClick:function(){return r("")},children:"Logout"}):"",Object(p.jsx)(l.a,{exact:!0,path:"/",children:Object(p.jsx)(x,{token:n})}),Object(p.jsx)(l.a,{exact:!0,path:"/posts",children:Object(p.jsx)(d,{token:n,posts:b,fetchPosts:f})}),Object(p.jsx)(l.a,{exact:!0,path:"/posts/:postId",children:Object(p.jsx)(k,{token:n,posts:b})}),Object(p.jsx)(l.a,{exact:!0,path:"/account",children:Object(p.jsx)(O,{setToken:r})}),Object(p.jsx)(l.a,{exact:!0,path:"/profile",children:Object(p.jsx)(v,{token:n})})]})};i.a.render(Object(p.jsx)(j.a,{children:Object(p.jsx)(S,{})}),document.getElementById("app"))}},[[33,1,2]]]);
//# sourceMappingURL=main.e31943f2.chunk.js.map